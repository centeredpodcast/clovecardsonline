<!DOCTYPE html>
<html lang="en">
<head>
    <title>Clove Cards</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="Clove Cards, Card Game">
    <meta name="description" content="An online card game!">
    <meta name="author" content="Sapphire7x and Savanna Campbell">
    <link rel="stylesheet" href="Resources/battle.css">
</head>
<body>
    <header>
        <!--<div>
            <img>
        </div>
        <nav>
            <ul></ul>
        </nav>-->
    </header>
    <main>
        <h1>Play the Game!</h1>
        <span id="turnCount"></span>
        <div id="board">
            <button class="1 endTurn one" onclick="changeTurns()" style="display: none;">End Turn</button>
            <button class="1 draw one" style="display: none;">Draw</button>
            <div class="1 deck one" onclick="shuffleDeck(1)"></div> <!-- this won't show anymore 'caus we show hands now-->
            <div class="1 hand one"></div> <!-- here is your board -->
            <div class="1 played one"></div>
            <div class="1 discard one"></div>
            <div class="2 played two"></div>
            <div class="2 discard two"></div>
            <div class="2 hand two"></div>
            <div class="2 deck two"></div>
            <button class="2 draw two" style="display: none;">Draw</button> <!-- draw button -->
            <button class="2 endTurn two" onclick="changeTurns()" style="display: none;">End Turn</button> <!-- end turn button -->
        </div>
        <!--<button class="testbutton">click me to add cards to your collection!</button>-->
    </main>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script> <!--jQuery!-->
    <script src="scripts/game.js"></script> <!--Calls game.js file-->
    <script src="scripts/functions.js"></script><!--Calls functions.js file-->
    
    <script src="scripts/onOpen.js"></script> <!--Calls the onOpen.js file-->
    <script>
        
        //TODO:
        // the #ability<ability number> detection system does not work. How to fix it? Add cardIDabilityAbilityNumber
        // ^ change each ability+something into cardid+ability+abilityid for every ability 
        //or i can go to the parent element, cardid<card number>abilities and edit the button through there
        //no, i think option one is better. <-- done

        //a played card disappeared for a moment after using northern tribesman's whirlwind

        //create an array for every card
        var listOfCards = decks[activeDeck].concat(decks[activeDeckPlayerTwo])
        //active player is player one at the beginning
        var activePlayer = 1;
        // set the turn count variable
        var turnCount = 1;
        //create a variable that will update when it's time to update the turn.
        var updateTurn = false;
        // create a variable that will update if you've played a card.
        var playedCardYet = false;
        // create a board variable with just the decks so far.
        var board = {
            player1Deck: decks[activeDeck],
            player1Hand: [],
            player1Played: [],
            player1Discard: [],
            player2Deck: decks[activeDeckPlayerTwo],
            player2Hand: [],
            player2Played: [],
            player2Discard: []
        }
        //create a shuffle function
        function shuffle(array) {
            let currentIndex = array.length; //there are this many cards in the array
            let temporaryValue; //temporary value
            let randomIndex; //random value
            // While there remain elements to shuffle...
            while (0 !== currentIndex) {

                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1; //Lower the currentIndex

                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }  
            // return the array
            return array;
        }
        function returnArray(array) { //function to return an array
            return array;
        }
        function sortCards(array, required) { //sort an array
            array = array.sort() //sort it
            returnArray(array) //return it
            if(required) displayBoard() //if required, then also show the board. <-- change this to show played cards?
        }
        function shuffleDeck(deckNumber) {
            //Set the deck to the deck but shuffled
            board["player" + deckNumber + "Deck"] = shuffle(board["player" + deckNumber + "Deck"])
        }
        function changeTurns() { //function to change turns
            activePlayer = (activePlayer)%2+1 //change the active player to 1/2, the other one.
            turnCount++ //update turncount
            updateTurn = true; //set update turn to true so effective changes can take place.
            displayBoard(); //display the board again.
        }
        function drawFromDeck() {
            //nothing -- placeholder.
        }
        if(!eligibleDeckOne) { //if deck one isn't eligible then display that.
            $("main").html("Deck One isn't eligible to play the game!")
        } else if(!eligibleDeckTwo) { //if deck two isn't eligible then display that.
            $("main").html("Deck Two isn't eligible to play the game!")
        } else { //if both decks are eligible.
            //change each card in board to ["name", id] 
            for(h in board.player1Deck) {
                board.player1Deck[h] = [board.player1Deck[h], h]
            }
            for(g in board.player2Deck) { //same thing but for player2.
                board.player2Deck[g] = [board.player2Deck[g], Number(g)+10]
            }
            
            var copyOfBoard = JSON.parse(JSON.stringify(board)) //create a copy of the board that doesnt change with it.
            var cardData = {
                card0: [cards[board.player1Deck[0][0]].Health, false],
                card1: [cards[board.player1Deck[1][0]].Health, false],
                card2: [cards[board.player1Deck[2][0]].Health, false],
                card3: [cards[board.player1Deck[3][0]].Health, false],
                card4: [cards[board.player1Deck[4][0]].Health, false],
                card5: [cards[board.player1Deck[5][0]].Health, false],
                card6: [cards[board.player1Deck[6][0]].Health, false],
                card7: [cards[board.player1Deck[7][0]].Health, false],
                card8: [cards[board.player1Deck[8][0]].Health, false],
                card9: [cards[board.player1Deck[9][0]].Health, false],
                card10: [cards[board.player2Deck[0][0]].Health, false],
                card11: [cards[board.player2Deck[1][0]].Health, false],
                card12: [cards[board.player2Deck[2][0]].Health, false],
                card13: [cards[board.player2Deck[3][0]].Health, false],
                card14: [cards[board.player2Deck[4][0]].Health, false],
                card15: [cards[board.player2Deck[5][0]].Health, false],
                card16: [cards[board.player2Deck[6][0]].Health, false],
                card17: [cards[board.player2Deck[7][0]].Health, false],
                card18: [cards[board.player2Deck[8][0]].Health, false],
                card19: [cards[board.player2Deck[9][0]].Health, false]
            } //set card data; each card: health, and whether or not the card was used this turn.

            for(i in cardData) {
                //for every card
                if(Number(i.replace("card", ""))<10) { //if the card id is less than 10
                    let newObject = {}; //create a new object
                    for(j in cards[board.player1Deck[i.replace("card", "")][0]]["Abilities"]) {
                        //for each of the cards abilities
                        newObject[Object.values(cards[board.player1Deck[i.replace("card", "")][0]]["Abilities"][j])[0]] = 0;
                        //add to new object theabilityid: 0
                        //the zero represents how many times the ability was used
                    }
                    cardData[i].push(newObject) //push it to cardData
                    
                } else {
                    //same thing but if the card is 10-20
                    let newObject = {};
                    for(j in cards[board.player2Deck[Number(i.replace("card", ""))-10][0]]["Abilities"]) {
                        newObject[Object.values(cards[board.player2Deck[Number(i.replace("card", ""))-10][0]]["Abilities"][j])[0]] = 0;
                    }
                    cardData[i].push(newObject)
                }
                cardData[i].push(false)
            }
            shuffleDeck(1) //shuffle each of the deccks
            shuffleDeck(2)
            decks = JSON.parse(JSON.stringify(decks)) //decks = decks.
            var playerDecks = { //set a new variable for each deck.
                playerDeck1: decks[activeDeck],
                playerDeck2: decks[activeDeckPlayerTwo]
            }

            //create a variable that will update if you use the kidnap ability
            var kidnapCheck = {}
            
            //split the shuffled deck into a hand and deck, hand with 4 cards each.
            board.player1Hand = board.player1Deck.splice(0, 4)
            board.player2Hand = board.player2Deck.splice(0, 4)
            function debugPanel() {
                if($("#boardDebug")) $("#boardDebug").remove()
                $("#board").after($("<div id='boardDebug'></div>"))
                for(i in board) {
                    console.log("hi")
                    for(j in board[i]) {
                        $("#boardDebug").prepend($("<div class='card'><p>" + board[i][j][0] + " ("+board[i][j][1]+"): " + i + "</p></div>"))
                    }
                }
            }
            function displayBoard() { //display the board function
                if(updateTurn) { //if you have to update turn
                    for(let d in cardData) {
                        cardData[d][3]=false;
                        cardData[d][1]=false; //reset every played card thing to false.
                    }
                    playedCardYet = false; //you have not played a card yet this new turn
                    updateTurn = false; //you no longer need to update your turn.
                }
                
                let endTurnChecks = {
                    //all the checks to see if an end turn forcibly happens, and then set up if statements to run the change turn function if everything here is true. todo!
                }
                function abilities(cardName, abilityID, cardID) { //function for each ability.
                    console.log(cardName)
                    console.log(abilityID)
                    console.log(cardID)
                    function abilityWasUsed() { //if an ability was used
                        cardData["card"+cardID][1] = true; //set the marker to true; you did use that ability.
                        cardData["card"+cardID][2][abilityID]++ //up the amount of times you've used each card's ability
                        debugPanel()
                    }
                    function errorMessage(errorMessage, abilityName, abilityButton, override) {
                        if(!override) $(abilityButton).replaceWith($("<span>Couldn't use ability " + abilityName + "; " + errorMessage + "</span>"))
                        if(override) {
                            $(abilityButton).replaceWith($("<span>"+override+" " + abilityName + "; " + errorMessage + "</span>"))
                        }
                    }
                    //If ability 0 (Desert Caravan's Barter) was used
                    if(Number(abilityID) === 0) { //idk what happened but it put in outlaw instead of the place of 5
                        //is it registering twice? should I unbind it and rebind it <- i dont think so
                        //its like backwards updating so that when I update it in the future it changes the past????
                        //maybe that's just google doing its auto update, but what should that change in the code?
                        if(board["player" + nonActivePlayer + "Hand"].length > 0) { //if the other person has cards in their hand
                            //get a random card from their hand
                            let randomCardOfOtherPerson = board["player" + nonActivePlayer + "Hand"][Math.floor(Math.random()*board["player" + nonActivePlayer + "Hand"].length)]
                            //get rid of Desert Caravan from your hands
                            let activeBoardCopy = JSON.parse(JSON.stringify(board["player" + activePlayer + "Played"]))
                            let cardIndex = myIndexOf(activeBoardCopy, [cardName, cardID])
                            console.log(cardIndex)
                            board["player" + activePlayer + "Played"].splice(cardIndex, 1)
                            //add the random card to your hand
                            board["player" + activePlayer + "Played"].push(randomCardOfOtherPerson)
                            //get rid of the random card from the other person's hand
                            let inactiveBoardCopy = JSON.parse(JSON.stringify(board["player" + nonActivePlayer + "Played"]))

                            let otherPersonCardIndex = myIndexOf(inactiveBoardCopy, randomCardOfOtherPerson)
                            board["player" + nonActivePlayer + "Hand"].splice(otherPersonCardIndex, 1)
                            //add desert caravan to your discard pile
                            board["player" + activePlayer + "Discard"].push([cardName, cardID])
                            //you used an ability
                            abilityWasUsed()
                            displayBoard() //redisplay the board.
                        } else {
                            //you dont have a card to take from the other person!
                            console.log("#"+cardID+"ability"+abilityID)
                            errorMessage("there is not a card to take from the your opponent!", "Barter", "#"+cardID+"ability"+abilityID)
                        }
                    } else if(Number(abilityID) === 1) { //if ability 1 (Desert Caravan's Roadkill) was used
                        //if the other person has played a card
                        if(board["player" + nonActivePlayer + "Played"].length > 0) {
                            let listOfPlayedCards = "Card to deal damage to: "; //start off what you're going to show with a prompt
                            for(let f in board["player" + nonActivePlayer + "Played"]) { //for each of their played cards
                                listOfPlayedCards += "<button class='roadKill roadkill"+board["player" + nonActivePlayer + "Played"][f][1]+"'>"+ board["player" + nonActivePlayer + "Played"][f][0] + "</button>"
                                //add a button that when clicked you'll deal damage to that card.
                            }
                            //add this list to the page
                            $("#"+cardID+"ability"+abilityID).parent().append(listOfPlayedCards)
                            $("#"+cardID+"ability"+abilityID).remove() //get rid of the button to play this ability
                            $(".roadKill").click(function(){ //when you click on a card to deal damage to
                                //deal 2 damage to that card
                                cardData["card"+$(this).attr("class").replace("roadKill", "").replace("roadkill", "").replace(" ", "")][0] -= 2
                                abilityWasUsed() //used an ability
                                displayBoard() //display the board again.
                            })
                        } else {
                            //there isnt a card to deal damage to!
                            errorMessage("your opponent has not played a card to deal damage to!", "Roadkill", "#"+cardID+"ability"+abilityID)
                        }
                    } else if(Number(abilityID) === 2) { //if ability 2 (Novice Explorer's Expedition) was used
                        //change playedcardyet to false, so you can play one more card!
                        playedCardYet = false; //if you use novice explorer multiple times, then should you be allowed to play multiple cards? Or should it be a feature that you have to use the card and then play new cards one at a time?
                        if(cardData["card"+cardID][2][abilityID]>0) { //if this card has been used more than once
                            let a = 0; //define a
                            while(a < board["player" + activePlayer + "Played"].length) { //while a in played cards
                                if(board["player" + activePlayer + "Played"][a][1]===cardID) { //if that is the played card id
                                    board["player" + activePlayer + "Played"].splice(a, 1) //get rid of that card from your played
                                    break; //i think theres a glitch here where it also deletes another of your cards but maybe thats fixed, i don't know.
                                    //stop the while loop.
                                } else {
                                    a++ //continue...
                                }
                            }
                            board["player" + activePlayer + "Discard"].push([cardName, cardID]) //add this card to the discard pile.
                        }
                        abilityWasUsed() //an ability was used
                        displayBoard() //redisplay the board
                        //should this not be able to run if there is not another card in your hand?
                    } else if(Number(abilityID) === 3) {//if ability 3 (Mooshlett's Spread the Spore) was used
                        //if the other person has played a card
                        console.log("hi")
                        if(board["player" + nonActivePlayer + "Played"].length > 0) {
                            let listOfPlayedCards = "Card to deal damage to: "; //start off what you're going to show with a prompt
                            for(let f in board["player" + nonActivePlayer + "Played"]) { //for each of their played cards
                                listOfPlayedCards += "<button class='spreadSpore spreadSpore"+board["player" + nonActivePlayer + "Played"][f][1]+"'>"+ board["player" + nonActivePlayer + "Played"][f][0] + "</button>"
                                //add a button that when clicked you'll deal damage to that card.
                            }
                            //add this list to the page
                            $("#"+cardID+"ability"+abilityID).parent().append(listOfPlayedCards)
                            $("#"+cardID+"ability"+abilityID).remove() //get rid of the button to play this ability
                            $(".spreadSpore").click(function(){ //when you click on a card to deal damage to
                                //deal 2 damage to that card
                                cardData["card"+$(this).attr("class").replace("spreadSpore", "").replace("spreadSpore", "").replace(" ", "")][0] -= 2
                                //create a copy of mooshlett
                                board["player" + activePlayer + "Hand"].push(["Mooshlett", String(Object.keys(cardData).length)])
                                //create a data entry for it
                                var objectToAdd = {}
                                objectToAdd[abilityID] = 0;
                                cardData["card"+Object.keys(cardData).length] = [cards["Mooshlett"].Health, false, objectToAdd, true]
                                listOfCards.push(cardName)
                                console.log(cardData)
                                console.log(board)
                                abilityWasUsed() //used an ability
                                displayBoard() //display the board again.
                            })
                        } else {
                            //there isnt a card to deal damage to!
                            errorMessage("your opponent has not played a card to deal damage to!", "Spread the Spore", "#"+cardID+"ability"+abilityID)
                        }
                    } else if(Number(abilityID) === 4) { //if ability 4 (Northern Tribesman's Arctic Slash) was used
                        //if the other person has played a card
                        if(board["player" + nonActivePlayer + "Played"].length > 0) {
                            let listOfPlayedCards = "Card to deal damage to: "; //start off what you're going to show with a prompt
                            for(let f in board["player" + nonActivePlayer + "Played"]) { //for each of their played cards
                                listOfPlayedCards += "<button class='arcticSlash arcticSlash"+board["player" + nonActivePlayer + "Played"][f][1]+"'>"+ board["player" + nonActivePlayer + "Played"][f][0] + "</button>"
                                //add a button that when clicked you'll deal damage to that card.
                            }
                            //add this list to the page
                            $("#"+cardID+"ability"+abilityID).parent().append(listOfPlayedCards)
                            $("#"+cardID+"ability"+abilityID).remove() //get rid of the button to play this ability
                            $(".arcticSlash").click(function(){ //when you click on a card to deal damage to
                                //deal 3 damage to that card
                                cardData["card"+$(this).attr("class").replace("arcticSlash", "").replace("arcticSlash", "").replace(" ", "")][0] -= 3
                                abilityWasUsed() //used an ability
                                displayBoard() //display the board again.
                            })
                        } else {
                            //there isnt a card to deal damage to!
                            errorMessage("your opponent has not played a card to deal damage to!", "Arctic Slash", "#"+cardID+"ability"+abilityID)
                        }
                    } else if(Number(abilityID) === 5) { //if ability 5 (Northern Tribesman's Whirlwind) was used
                        //if the other person has played a card <-- should this be two+ cards in play?
                        if(board["player" + nonActivePlayer + "Played"].length >= 2) {
                            let listOfPlayedCards = "Cards to deal damage to: "; //start off what you're going to show with a prompt
                            for(let f in board["player" + nonActivePlayer + "Played"]) { //for each of their played cards
                                listOfPlayedCards += "<button class='notSelected whirlwind whirlwind"+board["player" + nonActivePlayer + "Played"][f][1]+"'>"+ board["player" + nonActivePlayer + "Played"][f][0] + "</button>"
                                //add a button that when clicked you'll deal damage to that card.
                            }
                            listOfPlayedCards+="<button class='submitWhirlwind' style='display: none;'>Submit</button>"
                            //add this list to the page
                            $("#"+cardID+"ability"+abilityID).parent().append(listOfPlayedCards)
                            $("#"+cardID+"ability"+abilityID).remove() //get rid of the button to play this ability
                            var selectedCards = [];
                            $(".whirlwind").click(function(){ //if you click on a card to deal damage to
                                console.log($(this).attr("class"))
                                //get the name of the card you clicked
                                var thisCardName = listOfCards[$(this).attr("class").replace("whirlwind whirlwind", "").replace("notSelected", "").replace("selected", "").replace(" ", "")]
                                if($(this).hasClass("notSelected")) { //if it wasn't selected previously
                                    console.log("not selected")
                                    $(this).removeClass("notSelected").addClass("selected") //select it
                                    selectedCards.push(thisCardName) //add it to the list
                                    $(this).html(thisCardName+" | Selected") //say selected on its button
                                } else if($(this).hasClass("selected")) { //if it was selected previously
                                    console.log("selected")
                                    $(this).removeClass("selected").addClass("notSelected") //unselect it
                                    $(this).html(thisCardName) //reset its html
                                    selectedCards.splice(selectedCards.indexOf(thisCardName), 1); //delete it from the list
                                    //will this work? because you're indexing splices recursive all that
                                }
                                console.log(selectedCards)
                                if(selectedCards.length === 2) { //if there are two selected cards
                                    $(".submitWhirlwind").css("display", "inline") //show the submit button
                                } else {
                                    $(".submitWhirlwind").css("display", "none") //hide it otherwise
                                }
                            })
                            $(".submitWhirlwind").click(function(){
                                $(".selected").each(function() { //for each selected card
                                    //take away 2 health
                                    cardData["card"+$(this).attr("class").replace("selected", "").replace("whirlwind whirlwind", "").replace(" ", "")][0] -= 2
                                });
                                cardData["card"+cardID][0] -= 2 //get rid of 2 of your own health.
                                abilityWasUsed()
                                displayBoard()
                                //you have used your ability, and now redisplay everything.
                            })
                        } else {
                            //there isnt a card to deal damage to!
                            errorMessage("your opponent has not played two+ cards to deal damage to!", "Whirlwind", "#"+cardID+"ability"+abilityID)
                        }
                    } else if(Number(abilityID) === 6) { //if ability 6 (Mechanic's Tune Up) was used
                        //if you have played another card
                        if(board["player" + activePlayer + "Played"].length > 1) {
                            
                            //tune up is not working. fix
                            let listOfCardsToHeal = []; //start off what you're going to show with a prompt
                            for(let f in board["player" + activePlayer + "Played"]) { //for each of their played cards
                                console.log(f)
                                if(board["player" + activePlayer + "Played"][f][1] != cardID) { //for every card that isn't this mechanic card
                                    console.log(cardData["card"+board["player" + activePlayer + "Played"][f][1]][0])
                                    console.log(cards[listOfCards[board["player" + activePlayer + "Played"][f][1]]])
                                    if(cardData["card"+board["player" + activePlayer + "Played"][f][1]][0]<cards[listOfCards[board["player" + activePlayer + "Played"][f][1]]]["Health"]) {
                                        console.log(false)
                                        listOfCardsToHeal.push(board["player" + activePlayer + "Played"][f][1])
                                    }
                                    //listOfPlayedCards += "<button class='tuneUp tuneUp"+board["player" + activePlayer + "Played"][f][1]+"'>"+ board["player" + activePlayer + "Played"][f][0] + "</button>"
                                    //add a button that when clicked you'll heal that card.
                                }
                            }

                            if(JSON.stringify(listOfCardsToHeal)=="[]") { //all your cards are full health
                                //error message
                                console.log("hello??")
                                errorMessage("the rest of your cards in play are fully healed!", "Tune Up", "#"+cardID+"ability"+abilityID, "Could not use ability")
                            } else {
                                console.log("dlkf")
                                console.log(listOfCardsToHeal)
                                for(let e of listOfCardsToHeal) {
                                    cardData["card" + e][0]+=1 //heal 1 damage to each card to heal
                                    abilityWasUsed()
                                    displayBoard()
                                }
                            }

                            //add this list to the page
                            /*$("#ability" +abilityID).parent().append(listOfPlayedCards)
                            $("#ability" +abilityID).remove() //get rid of the button to play this ability
                            $(".tuneUp").click(function(){ //when you click on a card to heal
                                console.log(cards[listOfCards[$(this).attr("class").replace("tuneUp", "").replace("tuneUp", "").replace(" ", "")]]["Health"])
                                console.log(cardData["card"+$(this).attr("class").replace("tuneUp", "").replace("tuneUp", "").replace(" ", "")][0])
                                if(cardData["card"+$(this).attr("class").replace("tuneUp", "").replace("tuneUp", "").replace(" ", "")][0] < cards[listOfCards[$(this).attr("class").replace("tuneUp", "").replace("tuneUp", "").replace(" ", "")]]["Health"]) {
                                    cardData["card"+$(this).attr("class").replace("tuneUp", "").replace("tuneUp", "").replace(" ", "")][0] += 1
                                    //heal 1 damage to that card
                                    abilityWasUsed() //used an ability
                                    displayBoard() //display the board again.
                                } else { //the card is at full health
                                    errorMessage("this card is at full health!", listOfCards[$(this).attr("class").replace("tuneUp", "").replace("tuneUp", "").replace(" ", "")], ".tuneUp"+$(this).attr("class").replace("tuneUp", "").replace("tuneUp", "").replace(" ", ""), "Couldn't heal")
                                }

                                
                                
                            })*/
                        } else {
                            //there isnt a card to heal damage to!
                            errorMessage("you have not played another card to heal!", "Tune Up", "#"+cardID+"ability"+abilityID)
                        }
                    } else if(Number(abilityID) === 7) { //if ability 7 (Mechanic's Passion Project) was used
                        //if you have played another card
                        if(board["player" + activePlayer + "Played"].length > 1) {
                            let listOfPlayedCards = "Card to heal: "; //start off what you're going to show with a prompt
                            for(let f in board["player" + activePlayer + "Played"]) { //for each of their played cards
                                if(board["player" + activePlayer + "Played"][f][1] !== cardID) { //for every card that isn't this mechanic card
                                    listOfPlayedCards += "<button class='passionProject passionProject"+board["player" + activePlayer + "Played"][f][1]+"'>"+ board["player" + activePlayer + "Played"][f][0] + "</button>"
                                    //add a button that when clicked you'll heal that card.
                                }
                            }
                            //add this list to the page
                            $("#"+cardID+"ability"+abilityID).parent().append(listOfPlayedCards)
                            $("#"+cardID+"ability"+abilityID).remove() //get rid of the button to play this ability
                            $(".passionProject").click(function(){ //when you click on a card to heal
                                console.log(cards[listOfCards[$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")]]["Health"])
                                console.log(cardData["card"+$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")][0])
                                if(cardData["card"+$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")][0] < cards[listOfCards[$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")]]["Health"]) {
                                    //if the card is not max health
                                    cardData["card"+$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")][0] += 3
                                    //heal 3 damage to that card
                                    if(cardData["card"+$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")][0] > cards[listOfCards[$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")]]["Health"]) {
                                        //if it overhealed that card, reset it to max health
                                        cardData["card"+$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")][0] = cards[listOfCards[$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")]]["Health"]
                                    }
                                    abilityWasUsed() //used an ability
                                    displayBoard() //display the board again.
                                } else { //the card is at full health
                                    errorMessage("this card is at full health!", listOfCards[$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", "")], ".passionProject"+$(this).attr("class").replace("passionProject", "").replace("passionProject", "").replace(" ", ""), "Couldn't heal")
                                }
                            })
                        } else {
                            //there isnt a card to heal damage to!
                            errorMessage("you have not played another card to heal!", "Passion Project", "#"+cardID+"ability"+abilityID)
                        }
                    } else if(Number(abilityID) === 8) { //if ability 8 (Outlaw's Kidnap) was used
                        //if the other person has played a card
                        if(board["player" + nonActivePlayer + "Played"].length > 0) {
                            let listOfPlayedCards = "Card to deal damage to and restrict from using abilities: "; //start off what you're going to show with a prompt
                            for(let f in board["player" + nonActivePlayer + "Played"]) { //for each of their played cards
                                listOfPlayedCards += "<button class='kidnap kidnap"+board["player" + nonActivePlayer + "Played"][f][1]+"'>"+ board["player" + nonActivePlayer + "Played"][f][0] + "</button>"
                                //add a button that when clicked you'll deal damage to and restrict that card.
                            }
                            //add this list to the page
                            $("#"+cardID+"ability"+abilityID).parent().append(listOfPlayedCards)
                            $("#"+cardID+"ability"+abilityID).remove() //get rid of the button to play this ability
                            $(".kidnap").click(function(){ //when you click on a card to deal damage to
                                //deal 2 damage to that card
                                cardData["card"+$(this).attr("class").replace("kidnap", "").replace("kidnap", "").replace(" ", "")][0] -= 2
                                //restrict the card from using abilities next turn
                                kidnapCheck[turnCount+1] = $(this).attr("class").replace("kidnap", "").replace("kidnap", "").replace(" ", "")
                                abilityWasUsed() //used an ability
                                displayBoard() //display the board again.
                            })
                        } else {
                            //there isnt a card to deal damage to!
                            errorMessage("your opponent has not played a card to deal damage to!", "Kidnap", "#"+cardID+"ability"+abilityID)
                        }
                    } else if(Number(abilityID) === 9) { //if ability 9 (Outlaw's Never Surrender) was used
                        //create a new variable containing all the selected cards to deal damage to
                        var neverSurrenderSelected = {}    
                        //if the other person has played a card
                        if(board["player" + nonActivePlayer + "Played"].length > 0) {
                            let listOfPlayedCards = "" //the list of played cards is blank for now
                            for(let g = 1; g < 5; g++) { //loop 4 times, one for every damage point
                                listOfPlayedCards += "Damage Point "+g+": "; //start off what you're going to show with a prompt
                                for(let f in board["player" + nonActivePlayer + "Played"]) { //for each of their played cards
                                    listOfPlayedCards += "<button id='nS"+g+board["player" + nonActivePlayer + "Played"][f][1]+"' class='neverSurrender nS"+board["player" + nonActivePlayer + "Played"][f][1]+"'>"+ board["player" + nonActivePlayer + "Played"][f][0] + "</button>"
                                    //add a button that when clicked you'll deal damage to that card.
                                }
                            }
                            listOfPlayedCards += "<button class='submitNeverSurrender' style='display: none;'>Submit</button>" //add a button that will appear when 4 different cards are clicked
                            //add this list to the page
                            $("#"+cardID+"ability"+abilityID).parent().append(listOfPlayedCards) 
                            $("#"+cardID+"ability"+abilityID).remove() //get rid of the button to play this ability
                            $(".neverSurrender")
                                .unbind('click')
                                .click(function(){ //when you click a card to deal damage to
                                    console.log($(this).html())
                                    let previousCardName = $(this).html().replace(" | Selected", "")
                                    // get the name of the card

                                    // get the damage point number of the card
                                    let numberOfDamageCard = String($(this).attr("id")[2])
                                    // set the object to damage point number: card id
                                    neverSurrenderSelected[numberOfDamageCard] = $(this).attr("class").replace("neverSurrender", "").replace(" ", "").replace("nS", "").replace(" ", "").replace("nSSelected", "")
                                    $("[id^='nS"+numberOfDamageCard+"']").removeClass("nSSelected") //for every card in this damage point number, remove the nSSelected Class
                                    $("[id^='nS"+numberOfDamageCard+"']").each(function() { //for every card in this damage point number, get rid of | Selected from the title
                                        $(this).html($(this).html().replace(" | Selected", ""))
                                    });
                                    $(this).addClass("nSSelected") //add the class nSSelected to the card you picked
                                    $(this).html(previousCardName + " | Selected") // add | Selected to the card name
                                    console.log(neverSurrenderSelected)
                                    if($(".nSSelected").length == 4) { //if all four damage points have a card selected
                                        $(".submitNeverSurrender").css("display", "inline") //show the submit button
                                    } else { //otherwise
                                        $(".submitNeverSurrender").css("display", "none") //don't display the submit button
                                    }

                                    
                                
                                    /*if(neverSurrenderSelected.indexOf($(this).html()) == -1) {
                                        if($(".neverSurrenderSelected.neverSurrender" + $(this).attr("class").replace("neverSurrender", "").replace("neverSurrender", "").replace(" ", "").replace(" ", "").replace("neverSurrender", "")))
                                        $(this).html() = $(this).html().replace(" | Selected", "")
                                        $(this).removeClass("neverSurrenderSelected")
                                    } else {
                                        $(this).html() += " | Selected"
                                        $(this).addClass("neverSurrenderSelected")
                                    }*/
                                })
                            /*$(".neverSurrender1").click(function(){ //when you click on a card to deal damage to
                                //deal 1 damage to that card
                                cardData["card"+$(this).attr("class").replace("neverSurrender1", "").replace("neverSurrender1", "").replace(" ", "")][0] -= 1
                                kidnapCheck[turnCount+1] = $(this).attr("class").replace("neverSurrender1", "").replace("neverSurrender1", "").replace(" ", "")
                                //abilityWasUsed() //used an ability
                                //displayBoard() //display the board again.
                            })*/
                            $(".submitNeverSurrender").click(function() { //if you click the submit button
                                for(let o in neverSurrenderSelected) { //for every damage point
                                    console.log(neverSurrenderSelected[o])
                                    //take away one health
                                    cardData["card"+neverSurrenderSelected[o]][0] -= 1
                                }
                                let a = 0;
                                while(a < board["player" + activePlayer + "Played"].length) { //while a in your played cards
                                    if(board["player" + activePlayer + "Played"][a][1]===cardID) { //if that is the played card id
                                        board["player" + activePlayer + "Played"].splice(a, 1) //get rid of that card from your played
                                        break; 
                                        //stop the while loop.
                                    } else {
                                        a++ //continue...
                                    }
                                }
                                board["player" + activePlayer + "Discard"].push([cardName, cardID]); //add it to the discard pile.

                                abilityWasUsed() //you used an ability
                                displayBoard() //redisplay the board
                            })
                        } else {
                            //there isnt a card to deal damage to!
                            errorMessage("your opponent has not played a card to deal damage to!", "Never Surrender", "#"+cardID+"ability"+abilityID)
                        }
                    }
                } 
                
                var nonActivePlayer = (activePlayer)%2+1 //let nonactiveplayer be the other one.
                
                function showActivePlayerCards() { //display your active cards
                    let arrayOfCards = []; //set your cards
                    for(i in board["player" + activePlayer + "Hand"]) { //for every card in your hand
                        //push it to the array
                        arrayOfCards.push("<span id = 'activeCard"+i+"' class = 'active cardInHand cardID"+board["player" + activePlayer + "Hand"][i][1]+"'>" + board["player" + activePlayer + "Hand"][i][0] + "</span>")
                        if(!playedCardYet) { //if you haven't played a card yet, add a button to play it.
                            if(cardData["card"+board["player" + activePlayer + "Hand"][i][1]][3]===false) {
                                arrayOfCards[arrayOfCards.length - 1] +=" <button id='playCard"+i+"' class='playCardButton cardID"+board["player" + activePlayer + "Hand"][i][1]+"'>Play Card</button>"
                            }
                            
                        } else {
                            //otherwise don't display the button saying to play the card.
                        }
                    } 
                    
                    //arrayOfCards.push("<button id = 'sortCards' onclick = 'sortCards(board[\"player\" + " + activePlayer + " + \"Hand\"], true)'>Sort Cards</button>")
                    $("."+activePlayer+".hand").html("Player " + activePlayer + "'s Hand: " + "<br><span class='cardThatIsActive'>"+ arrayOfCards.join("</span><span class='cardThatIsActive'>")+"</span>") //set it to the page, divided by span elements.
                    //push a sort cards button at the end
                    $("."+activePlayer+".hand").html($("."+activePlayer+".hand").html() + "<button id = 'sortCards' onclick = 'sortCards(board[\"player\" + " + activePlayer + " + \"Hand\"], true)'>Sort Cards</button>")
                }
                function showInactivePlayerCards() { //display inactive cards
                    let arrayOfInactiveCards = []; //set the array
                    for(i in board["player" + nonActivePlayer + "Hand"]) { //for each one you get to see the back of the card
                        arrayOfInactiveCards.push("<span class='inactive' id = 'inactiveCard"+i+"'>" + "The back of the card lol" + "</span>")
                    } //set it to the board
                    $("."+nonActivePlayer+".hand").html("Player " + nonActivePlayer + "'s Hand: " + "<br>" + arrayOfInactiveCards.join(" | "))
                }
                function showActivePlayedCards() { //display your played cards
                    let arrayOfActivePlayedCards = []; //set an array
                    let i = 0;
                    while(i<board["player"+activePlayer+"Played"].length) { //for every played card
                        if(cardData["card"+board["player" + activePlayer + "Played"][i][1]][0]<=0) { //if this card's health is less than or equal to 0, discard it.
                            board["player" + activePlayer + "Discard"].push(board["player" + activePlayer + "Played"].splice(i, 1)[0])
                        } else { //otherwise
                            //set up a string for each card
                            let stringOfUseCards = "";
                            stringOfUseCards = stringOfUseCards + "<span id = 'playedCardActive"+i+"' class='cardID"+board["player" + activePlayer + "Played"][i][1]+"'>" + board["player" + activePlayer + "Played"][i][0] + "</span>"
                            //Add the name of the card
                            //add its health
                            console.log(board["player" + activePlayer + "Played"][i][0])
                            console.log(board["player" + activePlayer + "Played"][i])
                            console.log(board["player" + activePlayer + "Played"])
                            stringOfUseCards = stringOfUseCards + " Health: " + cardData["card" + board["player" + activePlayer + "Played"][i][1]][0] + "/" + cards[board["player" + activePlayer + "Played"][i][0]]["Health"] + " <span class='cardID"+board["player" + activePlayer + "Played"][i][1]+"Abilities'>"
                            
                            if(cardData["card"+board["player" + activePlayer + "Played"][i][1]][1]) { //if you have used this card already, then you can't use it again
                                stringOfUseCards+="You've already used this card once this turn!"
                            } else { //you havent used this card yet this turn
                                if(kidnapCheck[turnCount] && kidnapCheck[turnCount] == board["player" + activePlayer + "Played"][i][1]) {
                                    //If there is a card that is kidnapped this turn and it is this card, then display a message saying you cannot use this card
                                    stringOfUseCards += "This card cannot use abilities this turn under Outlaw's Kidnap!"
                                } else {
                                    for(j in cards[board["player" + activePlayer + "Played"][i][0]]["Abilities"]) { //for each of this card's abilities add a button
                                        stringOfUseCards = stringOfUseCards + " <button class='useCard"+i+" useCardButton' id='"+board["player" + activePlayer + "Played"][i][1]+"ability"+Object.values(cards[board["player" + activePlayer + "Played"][i][0]]["Abilities"][j])[0]+"'>Use Ability "+Object.keys(cards[board["player" + activePlayer + "Played"][i][0]]["Abilities"][j])[1]+"</button>"
                                    }
                                }
                            }
                            stringOfUseCards = stringOfUseCards + "</span>" //close the span element
                            arrayOfActivePlayedCards.push(stringOfUseCards) //push it to the array
                            i++
                        }      
                    }
                    //add it to the board, separated by |s
                    $("."+activePlayer+".played").html("Player " + activePlayer + "'s Played Cards: <span class='activePlayerPlayedCards'>" + arrayOfActivePlayedCards.join("</span><span class='activePlayerPlayedCards'>")+"</span>")
                }
                function showInactivePlayedCards() { //show inactive played cards
                    let arrayOfInActivePlayedCards = []; //set an array
                    let i = 0;
                    while(i<board["player" + nonActivePlayer + "Played"].length) {
                        if(cardData["card"+board["player" + nonActivePlayer + "Played"][i][1]][0]<=0) { //if the card has 0 or less health discard it
                            board["player" + nonActivePlayer + "Discard"].push(board["player" + nonActivePlayer + "Played"].splice(i, 1)[0])
                        } else { //otherwise
                            //set up a string
                            let stringOfPlayedCards = "";
                            stringOfPlayedCards = stringOfPlayedCards + "<span id = 'playedCardNonActive"+i+"' class='cardID"+board["player" + nonActivePlayer + "Played"][i][1]+"'>" + board["player" + nonActivePlayer + "Played"][i][0] + "</span>"
                            //add the card's name
                            //add its health
                            stringOfPlayedCards = stringOfPlayedCards + " <span>Health: " + cardData["card" + board["player" + nonActivePlayer + "Played"][i][1]][0] + "/" + cards[board["player" + nonActivePlayer + "Played"][i][0]]["Health"]
                            if(kidnapCheck[turnCount + 1] && kidnapCheck[turnCount + 1] == board["player" + nonActivePlayer + "Played"][i][1]) {
                                stringOfPlayedCards += " Outlaw's Kidnap: This card will not be able to use its abilities next turn."
                            }
                            for(j in cards[board["player" + nonActivePlayer + "Played"][i][0]]["Abilities"]) { //for each of its abilities add itss ability name
                                stringOfPlayedCards = stringOfPlayedCards + " <span class='nonActiveCardAbility"+i+"' id='ability"+Object.values(cards[board["player" + nonActivePlayer + "Played"][i][0]]["Abilities"][j])[0]+"'>Ability "+Object.keys(cards[board["player" + nonActivePlayer + "Played"][i][0]]["Abilities"][j])[1]+"</span>"
                            }
                            stringOfPlayedCards = stringOfPlayedCards + "</span>" //close the span element off
                            arrayOfInActivePlayedCards.push(stringOfPlayedCards) //push the string to the array
                            i++
                        }
                        //i++
                    }
                   /* for(i in board["player" + nonActivePlayer + "Played"]) { //for each of them
                        if(cardData["card"+board["player" + nonActivePlayer + "Played"][i][1]][0]<=0) { //if the card has 0 or less health discard it
                            board["player" + nonActivePlayer + "Discard"].push(board["player" + nonActivePlayer + "Played"].splice(i, 1)[0])
                        } else { //otherwise
                            //set up a string
                            let stringOfPlayedCards = "";
                            stringOfPlayedCards = stringOfPlayedCards + "<span id = 'playedCardNonActive"+i+"' class='cardID"+board["player" + nonActivePlayer + "Played"][i][1]+"'>" + board["player" + nonActivePlayer + "Played"][i][0] + "</span>"
                            //add the card's name
                            //add its health
                            stringOfPlayedCards = stringOfPlayedCards + " <span>Health: " + cardData["card" + board["player" + nonActivePlayer + "Played"][i][1]][0] + "/" + cards[board["player" + nonActivePlayer + "Played"][i][0]]["Health"]
                            for(j in cards[board["player" + nonActivePlayer + "Played"][i][0]]["Abilities"]) { //for each of its abilities add itss ability name
                                stringOfPlayedCards = stringOfPlayedCards + " <span class='nonActiveCardAbility"+i+"' id='ability"+Object.values(cards[board["player" + nonActivePlayer + "Played"][i][0]]["Abilities"][j])[0]+"'>Ability "+Object.keys(cards[board["player" + nonActivePlayer + "Played"][i][0]]["Abilities"][j])[1]+"</span>"
                            }
                            stringOfPlayedCards = stringOfPlayedCards + "</span>" //close the span element off
                            arrayOfInActivePlayedCards.push(stringOfPlayedCards) //push the string to the array
                        } 
                    }*/
                    //display the inactive played cards
                    $("."+nonActivePlayer+".played").html("Player " + nonActivePlayer + "'s Played Cards: " + arrayOfInActivePlayedCards.join(" | "))
                }
                function showDiscardPiles() { //show the discard piles
                    if(board["player" + activePlayer + "Discard"].length === 0) { //if your discard pile is empty then just show a label.
                        $("."+activePlayer+".discard").html("Player " + activePlayer + "'s Discard Pile: ")
                    } else { //show the label and the top card's name otherwise.
                        $("."+activePlayer+".discard").html("Player " + activePlayer + "'s Discard Pile: <span class='cardID" + board["player" + activePlayer + "Discard"][board["player" + activePlayer + "Discard"].length - 1][1] + "'>" + board["player" + activePlayer + "Discard"][board["player" + activePlayer + "Discard"].length - 1][0] + "</span>")
                    }
                    //same thing for non active cards.
                    if(board["player" + nonActivePlayer + "Discard"].length === 0) {
                        $("."+nonActivePlayer+".discard").html("Player " + nonActivePlayer + "'s Discard Pile: ")
                    } else {
                        $("."+nonActivePlayer+".discard").html("Player " + nonActivePlayer + "'s Discard Pile: <span class='cardID" + board["player" + nonActivePlayer + "Discard"][board["player" + nonActivePlayer + "Discard"].length - 1][1] + "'>" + board["player" + nonActivePlayer + "Discard"][board["player" + nonActivePlayer + "Discard"].length - 1][0] + "</span>")
                    }
                }
                showActivePlayerCards() //show your hand
                showInactivePlayerCards() //show the back of the other players hand
                showActivePlayedCards() //show your played cards
                showInactivePlayedCards() //show their played cards
                showDiscardPiles() //show the discard piles

                $("."+activePlayer+".endTurn").css("display", "block") //show the end turn button for you
                $("."+nonActivePlayer+".endTurn").css("display", "none") //hide it for the other person
                $("." + activePlayer + ".draw").css("display", "block") //show your draw button <- how will drawing work in game?
                $("." + nonActivePlayer + ".draw").css("display", "none") //hide it for them
                $("#turnCount").html("Turn Count: " + turnCount) //show the turn count

                function hotkeys() { //hotkeys function for clicks/hovers
                    $(".draw")
                        .unbind('click')
                        .click(function(){
                            if(board["player" + activePlayer + "Deck"].length > 0) { //if there are cards to draw
                                //move a card from your deck to your hand.
                                board["player" + activePlayer + "Hand"].push(board["player" + activePlayer + "Deck"].splice(0, 1)[0]) //why did i have to [0] here? oh, because otherwise it would return it as [["hello", "yes"]]
                                showActivePlayerCards() //reshow your hand
                                hotkeys() //recall hotkeys so they will still work.
                            } else { //no cards left to draw
                                $(this).html("There are no more cards left to draw!")
                            }
                        })
                    //when you click draw
                    
                    $(".playCardButton").click(function(){ //if you click on the play card button
                        playedCardYet = true; //set it to true, you have played a card now!
                        board["player"+activePlayer+"Hand"].splice($(this).attr("id").replace("playCard", ""), 1) //get rid of the card from your hand
                        //add it to your played section
                        board["player"+activePlayer+"Played"].push([listOfCards[$(this).attr("class").replace("playCardButton", "").replace("cardID", "").replace(" ", "")], $(this).attr("class").replace("playCardButton", "").replace("cardID", "").replace(" ", "")])
                        showActivePlayedCards() //show your played cards
                        showActivePlayerCards() //show your hand
                        hotkeys() //recall hotkeys so they will still work.
                    })

                    $(".useCardButton").click(function(){ //if you click on a use abillity button
                        //run the abilities function (cardName, abilityID, cardID)
                        console.log(board)
                        console.log($(this).attr("class").replace("useCardButton", "").replace("useCard", "").replace(" ", ""))
                        console.log(board["player"+activePlayer+"Played"][$(this).attr("class").replace("useCardButton", "").replace("useCard", "").replace(" ", "")])
                        abilities(String(board["player"+activePlayer+"Played"][$(this).attr("class").replace("useCardButton", "").replace("useCard", "").replace(" ", "")][0]), String($(this).attr("id").replace($(this).parent().attr("class").replace("cardID", "").replace("Abilities", ""), "").replace("ability", "")), String($(this).parent().attr("class").replace("cardID", "").replace("Abilities", "")))
                    })
                    
                    $(".cardInHand").hover(function(){ //if you hover over a card in your hand
                        let cardAbilityDescription = []; //set an array
                        for(i in cards[$(this).html()]["Abilities"]) { //for each ability
                            //push the array with the name: description
                            cardAbilityDescription.push(Object.keys(cards[$(this).html()]["Abilities"][i])[1] + ": " + Object.values(cards[$(this).html()]["Abilities"][i])[1])
                        }
                        //show the array separated by commas.
                        $(this).append("<span id='hovered"+$(this).attr("id").replace("activeCard", "")+"'> Abilities: " + cardAbilityDescription.join("; "))
                    }, function(){ //when you unhover over it
                        $("#hovered"+$(this).attr("id").replace("activeCard", "")).remove() //remove the explanation
                    })
                    $(".played [id^='playedCard']").hover(function(){ //same thing but if you hover over a played card.
                        let cardAbilityDescription = [];
                        for(i in cards[$(this).html()]["Abilities"]) {
                            cardAbilityDescription.push(Object.keys(cards[$(this).html()]["Abilities"][i])[1] + ": " + Object.values(cards[$(this).html()]["Abilities"][i])[1])
                        }
                        $(this).append("<span id='hovered"+$(this).attr("id")+"'>Abilities: " + cardAbilityDescription.join(", "))
                    }, function(){
                        $("#hovered"+$(this).attr("id")).remove()
                    })
                    debugPanel()
                }
                hotkeys() //call the hotkeys originally so they work off the ba
                
                debugPanel()
            }
            //show the board when you load the page.
            displayBoard()
        }
    </script>
    <script src="scripts/abilities.js"></script> <!--access the abilities.js file <-- which has nothing (if it does, I should delete it and maybe this call to access it).-->
</body>
</html>
